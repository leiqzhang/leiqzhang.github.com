<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Archives: 2010/11 | Technology &amp; Life</title>
  <meta name="author" content="leiqzhang">
  
  <meta name="description" content="Virtualization Related Technologies">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Technology &amp; Life"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Technology &amp; Life" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Technology &amp; Life</a></h1>
  <h2><a href="/">blog of leiqzhang</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
<h2 class="archive-title">2010/11</h2>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2010-11-30T13:27:24.000Z"><a href="/2010/11/2010-11-30-http-proxy-request-uri/">Nov 30 2010</a></time>
      
      
  
    <h1 class="title"><a href="/2010/11/2010-11-30-http-proxy-request-uri/">HTTP请求头中Request-URI的取值和代理服务器proxy的关系</a></h1>
  

    </header>
    <div class="entry">
      
        <p>一个合法的HTTP URL的格式如下：</p>
<p>[code]http_URL = &quot;http:&quot; &quot;//&quot; host [ &quot;:&quot; port ] [ abs_path [ &quot;?&quot; query ]][/code]</p>
<p>当访问一个网站时，http的请求头中会包含一个Request-URI字段，该字段可以有四种类型的取值：</p>
<p>[code]Request-URI    = &quot;*&quot; | absoluteURI | abs_path | authority[/code]</p>
<p>其中星号&quot;*&quot;表示客户端请求的是服务器本身，而并没有请求特定的资源；authority格式只用于http协议的CONNECT方法。这两种本文不进行讨论，下面主要看另外两种</p>
<p>当请求是发送给代理服务器时，必须使用absoluteURI(绝对URI)格式。代理服务器需要转发该请求或者直接从本地的cache给出响应。需要注意的，代理服务器可能会将该
请求转发给另一个代理服务器，也可能会按照absoluteURI直接发送给相应的服务器。如我们需要通过代理服务器访问被墙掉的Facebook时，可以看到请求头如下：</p>
<p><img src="http://leivli.duapp.com/wp-content/uploads/2010/11/13.png" alt=""></p>
<p>其它情况下，http请求头中的RequestURI将会使用一个资源相对地址abs_path,并加上一个Host头，供web服务器通过Host和RequestURI生成相应的URI，当我们输入的
url没有abs_path时，则传递的RequestURI中的abs_path将自动设置为&#39;/&#39;。如我们直接访问我们的百度时，请求头如下：</p>
<p><img src="http://leivli.duapp.com/wp-content/uploads/2010/11/21.png" alt=""></p>
<p>结论：</p>
<p>当通过代理服务器访问某个URL时，发送的RequestURI必须时一个绝对URI，否则将发送一个相对资源地址，即http_url中的abs_path段(及后面的query)</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2010-11-29T12:37:07.000Z"><a href="/2010/11/2010-11-29-diff_svn_tree_conflict/">Nov 29 2010</a></time>
      
      
  
    <h1 class="title"><a href="/2010/11/2010-11-29-diff_svn_tree_conflict/">整体diff比较SVN的tree conflict文件</a></h1>
  

    </header>
    <div class="entry">
      
        <p>通过svn merge合并代码时经常会报树冲突(tree conflict)，而对于每个树冲突不能简单的忽略了事，需要和待merge版本相应的文件进行diff才可以。</p>
<p>目前我们组的并行项目很多，svn merge时，树冲突往往非常多，一个一个手动去diff是一个很繁琐的过程，下午大概写了一个shell方法对所有树冲突的文件进行diff，可以将以下代码加入~/.bash_profile文件：</p>
<p>[shell]</p>
<h1>设定项目所在目录</h1>
<p>export PRJ=/home/work/var/www/htdocs</p>
<h1>根据svn info获取当前目录层次，并构造相应的diff目的文件路径</h1>
<h1>如当前在$PRJ/pro_merge/protected/modules/operations下</h1>
<h1>则&quot;getDir $PRJ/pro&quot;的结果是$PRJ/pro/protected/modules/operations</h1>
<h1>当然前提是svn info中的URL行对应的格式是<a href="https://*/*_BRANCH/protected/modules/operations或https://*/*_PD_BL/protected/modules/operations">https://*/*_BRANCH/protected/modules/operations或https://*/*_PD_BL/protected/modules/operations</a></h1>
<h1>可根据实际情况进行修改</h1>
<p>function getDir() { DIR=<code>echo $1 | sed &#39;s/\//\\\\\//g&#39;</code>; svn info | grep &quot;^URL&quot; | awk &#39;{print $2}&#39; | sed &quot;s/^https:.*(_BRANCH|_PD_BL)/$DIR/g&quot;; }</p>
<h1>通过svn st和awk获取所有树冲突文件相对路径</h1>
<h1>依次和指定的目标文件进行diff,其中忽略了对.png .gif等类型文件的处理</h1>
<p>function td() { svn st | grep &quot;^[[:space:]]+C&quot; | awk &#39;$2!~/(.<em>.png)|(.</em>.gif)/ {print $2}&#39; | xargs -t -i diff -u --exclude=&quot;.svn&quot; {} &quot;<code>getDir $1</code>/{}&quot;; }
[/shell]</p>
<p>假设合并代码后的目录是$PRJ/pro_merge,而合入的版本代码在$PRJ/pro_src,则可以在$PRJ/pro_merge的任意子目录下执行如下命令：</p>
<p>[shell]
td $PRJ/pro_src
[/shell]</p>
<p>即可输出当前目录下所有子目录的树冲突文件和带合并文件的diff情况</p>
<p>+++++++2010年12月6日更新++++++++++</p>
<p>该方法可以进一步扩展，将diff出来的没有不同的文件直接”svn resolved“了，因此写了一个简单的shell脚本：</p>
<p>[bash]</p>
<h1>! /bin/sh</h1>
<p>function getDir() { DIR=<code>echo $1 | sed &#39;s/\//\\\\\//g&#39;</code>; svn info | grep &quot;^URL&quot; | awk &#39;{print $2}&#39; | sed &quot;s/^https:.*(_BRANC
H|_PD_BL)/$DIR/g&quot;; }</p>
<p>files=<code>svn st | grep &quot;^[[:space:]]\+C&quot; | awk &#39;$2!~/(.*\.png)|(.*\.gif)/ {print $2}&#39;</code>
dir=<code>getDir $1</code>
for file in $files
do
    echo &quot;$file&quot;
    out=<code>diff -ur --exclude=&quot;\.svn&quot; &quot;$file&quot; &quot;$dir/$file&quot; 2&gt;&amp;1</code>
    if [ $? -eq &quot;0&quot; ]
    then
        echo will svn resolved $file
        svn resolved $file
    else
        echo &quot;$out&quot;
    fi
done</p>
<p>[/bash]</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2010-11-23T17:57:46.000Z"><a href="/2010/11/2010-11-24-http-cache/">Nov 24 2010</a></time>
      
      
  
    <h1 class="title"><a href="/2010/11/2010-11-24-http-cache/">HTTP Cache相关</a></h1>
  

    </header>
    <div class="entry">
      
        <h2>Advanced Note：</h2>
<h3>Expiration</h3>
<p>Expires header</p>
<p>Cache-Control header</p>
<h3>Validation</h3>
<p>Last-Modified header</p>
<p>ETag header</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2010-11-22T16:35:16.000Z"><a href="/2010/11/2010-11-23-css-block-formatting-context/">Nov 23 2010</a></time>
      
      
  
    <h1 class="title"><a href="/2010/11/2010-11-23-css-block-formatting-context/">CSS的block formatting context</a></h1>
  

    </header>
    <div class="entry">
      
        <p><strong>什么是块格式化内容：Block Formatting Context （BFC）</strong>
网页布局的时候，BFC会在常规流(与之并列的是浮动和绝对定位)中进行布局。BFC提供了一个环境，使得html元素在该环境内按照一定规则进行布局，而不会影响其它环境中的布局</p>
<p><strong>什么情况下生成BFC</strong></p>
<p>当一个元素满足以下条件时，它的包含块将会形成一个BFC：</p>
<ul>
<li>浮动(float属性非none)</li>
</ul>
<ul>
<li>overflow属性的计算值不是visible</li>
</ul>
<ul>
<li>display属性是table-cell、table-caption或着inline-block</li>
</ul>
<ul>
<li>绝对定位(position非static且非relative)</li>
</ul>
<p>需要注意的是，disaply属性为table时并不会建立一个BFC。但是由于display为table时，元素将会生成一个匿名框，这些框会具有display:table-cell属性，故会建立新的BFC。也就是说，建立BFC的是这个display为table-cell的匿名框而非table。所以在display:table和display:table-cell的元素上使用clear属性的效果是不一样的（见最后一小节示例）。
<strong>BFC的影响</strong></p>
<ol>
<li>rule 1. 在bfc内部，垂直相邻的框的margin将会折叠(collapse)</li>
</ol>
<ol>
<li>rule 2. 在同一个bfc内部，所有框的左外边均挨着包含块(bfc)的左侧(rtl时,是右外边挨着包含块的右侧)。即使该bfc中包含float元素也是如此，除非该bfc内部另外一个元素形成了一个新的bfc，这种情况下，该元素的框将会挨着float元素排列，宽度可能会由于float元素的存在而变窄</li>
</ol>
<ol>
<li>rule 3. 一个BFC的border-box不能和与其在同一个BFC的float元素的margin-box相互重叠。这就意味着，浏览器会在BFC上生成不可见的margin来避免它和float元素的margin-box相互重叠。所以，在紧接着float元素的BFC上设置负的margin是没有作用的。而且BFC的margin还是可以和float元素重叠的，不能重叠的只是border-box。</li>
</ol>
<ol>
<li>rule 4.  clear只能清除处于同一个bfc的元素</li>
</ol>
<p><strong>Rule 1 BFC and margin collapse</strong>
从rule 1可知，垂直相邻的框的margin发生collapse的情况只会发生在这两个相邻框在同一个bfc的情形下，而如果两个垂直相邻的框分属于不同的bfc,则不会发生折叠。
如下例:</p>
<p>[html]</p>
<h3>margin collapse in the same BFC:</h3>

 <div style="background-color:skyBlue">
     <p style="margin-bottom:20px;border:1px solid red">
        this is text 1 with style: <br/> {margin-bottom:20px;border:1px solid red}
     </p>
 </div>
 <div style="background-color:skyBlue">
     <p style="margin-top:10px;border:1px solid black">
        this is text 2 with style: <br/> {margin-top:10px;border:1px solid black&quot;}
     </p>
 </div>

 <h3>margin not collapse in different BFCs</h3>
 <div style="background-color:skyBlue">
     <p style="margin-bottom:20px;border:1px solid red">
        this is text 3 with style: <br/> {margin-bottom:20px;border:1px solid red}
     </p>
 </div>
 <div style="background-color:skyBlue;overflow:hidden">
     <p style="margin-top:10px;border:1px solid black">
        this is text 4 with style: <br/> {margin-top:10px;border:1px solid black&quot;} <br/>
        <b>but the containing div has property: &quot;overflow:hidden&quot;, make this div establish a new BFC</b>
     </p>
 </div>
[/html]

效果如下图所示，前两个段落中间的margin发生了collapse，变为了较大的20px，而下面两个段落并未发生collapse，总共是30px
<img src="http://leivli.duapp.com/wp-content/uploads/2010/11/12-1024x286.png" alt="">

因此在需要避免margin collapse时，可以通过构建BFC来实现，这也是为什么浮动的元素和绝对定位的元素不会发生margin collapse的原因了

<strong>Rule 2 float in the BFC</strong>

如果一个无top/bottom border、无top/bottom padding且不形成bfc的div内部包含多个float元素，由于float元素是脱离文档流的，所以即使该div具有margin，也会由于margin相邻而会发生collapse，从而形成一个零高度的div。如果多个这样的div相邻，如果水平空间允许，那么这些div中的float元素将会排列在同一行上，这可能并非预期的效果。如本意要布局一个两行两列div的如下代码片段:

[html]
 <h3>float in zero height divs of the same BFC</h3>

 <div style="margin:20px">
      <div style="float:left;border:1px solid green;background-color:red">float div r1c1</div>
      <div style="float:left;border:1px solid green;background-color:blue">float div r1c2</div>
 </div>

 <div style="margin:20px">
      <div style="float:left;border:1px solid green;background-color:gray">float div r2c1</div>
      <div style="float:left;border:1px solid green;background-color:yellow">float div r2c2</div>
 </div>
[/html]

将生成下列效果的页面,四个浮动框会排列在一行上，而非预期的两行两列布局:

<img src="http://leivli.duapp.com/wp-content/uploads/2010/11/2.png" alt="">

由rule 2可知，在同一个BFC内部，所有框的左外边会挨着左侧排列，即使包含float元素也是如此。因此，如果将上例中的两个div各自均改为BFC，就会达到预期的目的。由于bfc内部两个float元素均会各自生成一个bfc，这两个bfc就会并排排列（如果bfc宽度足够的话，如果不够，由于都是float，第二个float会下移)。而这两个不同BFC又处于初始包含块的BFC中，将会按照常规流进行布局，即第二个BFC排在第一个BFC下面，形成2行2列的样式：


    <span style="text-decoration: line-through;">
    <h3>float in zero height divs of the same BFC</h3>

     <div style="margin:20px">
    <div style="float:left;border:1px solid green;background-color:red">float div r1c1</div>
    <div style="float:left;border:1px solid green;background-color:blue">float div r1c2</div>
     </div>

<pre><code><figure class="highlight"><pre> <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"margin:20px"</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:left;border:1px solid green;background-color:gray"</span>&gt;</span>float div r2c1<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:left;border:1px solid green;background-color:yellow"</span>&gt;</span>float div r2c2<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">div</span>&gt;</span><span class="tag">&lt;/<span class="title">span</span>&gt;</span>
[html]
<span class="tag">&lt;<span class="title">h3</span>&gt;</span>float in zero height divs of different BFCs<span class="tag">&lt;/<span class="title">h3</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"margin:20px;overflow:hidden"</span>&gt;</span>
      <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:left;border:1px solid green;background-color:red"</span>&gt;</span>float div r1c1<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
      <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:left;border:1px solid green;background-color:blue"</span>&gt;</span>float div r1c2<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"margin:20px;overflow:hidden"</span>&gt;</span>
      <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:left;border:1px solid green;background-color:gray"</span>&gt;</span>float div r2c1<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
      <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:left;border:1px solid green;background-color:yellow"</span>&gt;</span>float div r2c2<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

[/html]



实际布局效果如下图：

<span class="tag">&lt;<span class="title">img</span> <span class="attribute">src</span>=<span class="value">"http://leivli.duapp.com/wp-content/uploads/2010/11/3.png"</span> <span class="attribute">title</span>=<span class="value">"float_in_bfc"</span> <span class="attribute">height</span>=<span class="value">"131"</span> <span class="attribute">width</span>=<span class="value">"519"</span> <span class="attribute">alt</span>=<span class="value">""</span> <span class="attribute">class</span>=<span class="value">"aligncenter size-full wp-image-92"</span>&gt;</span><span class="tag">&lt;/<span class="title">img</span>&gt;</span>

<span class="tag">&lt;<span class="title">strong</span>&gt;</span>Rule 3 BFC  adjoin float<span class="tag">&lt;/<span class="title">strong</span>&gt;</span>

一个普通的div元素(未生成新的BFC)是会被相邻的float元素覆盖的，而一个生成BFC的div元素的border-box是不会被相邻的float元素覆盖的，但是其margin可以被覆盖。如下面的代码：
 [html]

<span class="tag">&lt;<span class="title">h3</span>&gt;</span>float and normal div overlap<span class="tag">&lt;/<span class="title">h3</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:left;background-color:gray"</span>&gt;</span>float div<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"background-color:yellow;border:1px solid red"</span>&gt;</span> normal div <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

 <span class="tag">&lt;<span class="title">h3</span>&gt;</span>float and bfc div no overlap<span class="tag">&lt;/<span class="title">h3</span>&gt;</span>
 <span class="tag">&lt;<span class="title">p</span>&gt;</span>both divs have no margin<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:left;background-color:gray"</span>&gt;</span>float div<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"background-color:yellow;border:1px solid red;overflow:hidden"</span>&gt;</span> bfc div <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

 <span class="tag">&lt;<span class="title">p</span>&gt;</span>bfc div has margin<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:left;background-color:gray"</span>&gt;</span>float div<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"background-color:yellow;border:1px solid red;overflow:hidden;margin-left:10px"</span>&gt;</span> bfc div <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

 <span class="tag">&lt;<span class="title">p</span>&gt;</span>float div has margin<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:left;background-color:gray;margin-right:10px;margin-right:10px"</span>&gt;</span>float div<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"background-color:yellow;border:1px solid red;overflow:hidden"</span>&gt;</span> bfc div <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

[/html]



生成的效果如下图：

<span class="tag">&lt;<span class="title">img</span> <span class="attribute">src</span>=<span class="value">"http://leivli.duapp.com/wp-content/uploads/2010/11/4-1024x209.png"</span> <span class="attribute">title</span>=<span class="value">"float_adjoin_bfc"</span> <span class="attribute">height</span>=<span class="value">"209"</span> <span class="attribute">width</span>=<span class="value">"1024"</span> <span class="attribute">alt</span>=<span class="value">""</span> <span class="attribute">class</span>=<span class="value">"aligncenter size-large wp-image-93"</span>&gt;</span><span class="tag">&lt;/<span class="title">img</span>&gt;</span>如图所示，前两个div中，float的div会和另一个div发生重叠，而后面三个示例可以看出，float框不会和相邻的bfc的border box发生重叠。正如rule 3所述，float和bfc的border box不会发生重叠：
当float和bfc都没有margin时，两者紧邻；当bfc有left margin时，该left margin可以被float框覆盖，两者还是紧邻；当float框有right margin时，bfc并不能将其覆盖。

再看另外一个例子，不多说，贴代码:
 [html]

<span class="tag">&lt;<span class="title">h3</span>&gt;</span>float and bfc div no overlap: another example<span class="tag">&lt;/<span class="title">h3</span>&gt;</span>

 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"overflow:hidden"</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:left;background-color:red;width:200px"</span>&gt;</span>first: left float div<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:right;background-color:green;width:200px"</span>&gt;</span>second: right float div<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"overflow:hidden;background-color:yellow"</span>&gt;</span>third: bfc div<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"overflow:hidden"</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:left;background-color:red;margin-right:20px;width:200px"</span>&gt;</span>first: left float div<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:right;background-color:green;margin-left:20px;width:200px"</span>&gt;</span>second: right float div<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"overflow:hidden;background-color:yellow"</span>&gt;</span>third: bfc div<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"overflow:hidden"</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:left;background-color:red;width:200px"</span>&gt;</span>first: left float div<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"float:right;background-color:green;width:200px"</span>&gt;</span>second: right float div<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"overflow:hidden;background-color:yellow;margin:0 220px"</span>&gt;</span>third: bfc div<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

[/html]



实际运行效果图：

<span class="tag">&lt;<span class="title">img</span> <span class="attribute">src</span>=<span class="value">"http://leivli.duapp.com/wp-content/uploads/2010/11/5-1024x95.png"</span> <span class="attribute">title</span>=<span class="value">"float_adjoin_bfc_another"</span> <span class="attribute">height</span>=<span class="value">"95"</span> <span class="attribute">width</span>=<span class="value">"1024"</span> <span class="attribute">alt</span>=<span class="value">""</span> <span class="attribute">class</span>=<span class="value">"aligncenter size-large wp-image-94"</span>&gt;</span><span class="tag">&lt;/<span class="title">img</span>&gt;</span>

该例子中有三组，各组均有三个div，分别为float left（width:200px）、float right（width:200px）和无float的third div（一个bfc），每组的包含div具有overflow:hidden，故会形成一个bfc，
即各组的三个div均处于一个独立的BFC中。

第一组中，根据Rule3， third div形成的bfc不会和float div发生重叠，因此在水平空间足够的情况下，三个div会排在一行，中间没有间隙。此时在third div上应用margin并不会在third div的两边和float div
交界处形成空隙。因为这种情况下，如果需要在中间框的左右两侧产生空隙，通过给该框添加margin是无法做到的，但是可以采用以下两个方法做到：

<span class="tag">&lt;<span class="title">ul</span>&gt;</span>

    <span class="tag">&lt;<span class="title">li</span>&gt;</span> 在两边的float上设置margin，如上图第二组所示<span class="tag">&lt;/<span class="title">li</span>&gt;</span>


    <span class="tag">&lt;<span class="title">li</span>&gt;</span> 给third div设置一个大于两边float框宽度的margin，如上图第三组所示<span class="tag">&lt;/<span class="title">li</span>&gt;</span>

<span class="tag">&lt;/<span class="title">ul</span>&gt;</span>


<span class="tag">&lt;<span class="title">strong</span>&gt;</span>Rule 4 BFC and clear<span class="tag">&lt;/<span class="title">strong</span>&gt;</span>
 clear只能清除处于同一个bfc的float元素，这里给出的例子说明了该点，同时也表示了第一段提到的在table元素和table-cell元素上使用clear的不同:
 [html]

<span class="tag">&lt;<span class="title">h3</span>&gt;</span>BFC &amp; clear -- clear on display:talbe vs clear on display:table-cell<span class="tag">&lt;/<span class="title">h3</span>&gt;</span>

 <span class="tag">&lt;<span class="title">p</span> <span class="attribute">style</span>=<span class="value">"clear:left"</span>&gt;</span>normal div after float div without clear<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"border:1px solid red"</span>&gt;</span>
<span class="tag">&lt;<span class="title">p</span> <span class="attribute">style</span>=<span class="value">"float:left;background-color:gray;color:white;border:1px solid green"</span>&gt;</span>
line 1<span class="tag">&lt;<span class="title">br</span>/&gt;</span>
line 2
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"border:2px solid yellow"</span>&gt;</span>div content<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

 <span class="tag">&lt;<span class="title">p</span> <span class="attribute">style</span>=<span class="value">"clear:left"</span>&gt;</span>normal div after float div with clear<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"border:1px solid red"</span>&gt;</span>
<span class="tag">&lt;<span class="title">p</span> <span class="attribute">style</span>=<span class="value">"float:left;background-color:gray;color:white;border:1px solid green"</span>&gt;</span>
line 1<span class="tag">&lt;<span class="title">br</span>/&gt;</span>
line 2
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"border:2px solid yellow;clear:left"</span>&gt;</span>div content<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

 <span class="tag">&lt;<span class="title">p</span> <span class="attribute">style</span>=<span class="value">"clear:left"</span>&gt;</span>display:table after float div without clear<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"border:1px solid red"</span>&gt;</span>
<span class="tag">&lt;<span class="title">p</span> <span class="attribute">style</span>=<span class="value">"float:left;background-color:gray;color:white;border:1px solid green"</span>&gt;</span>
line 1<span class="tag">&lt;<span class="title">br</span>/&gt;</span>
line 2
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"display:table;border:2px solid yellow"</span>&gt;</span><span class="tag">&lt;<span class="title">span</span>&gt;</span>div content<span class="tag">&lt;/<span class="title">span</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

 <span class="tag">&lt;<span class="title">p</span> <span class="attribute">style</span>=<span class="value">"clear:left"</span>&gt;</span>display:table after float div with clear<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"border:1px solid red"</span>&gt;</span>
<span class="tag">&lt;<span class="title">p</span> <span class="attribute">style</span>=<span class="value">"float:left;background-color:gray;color:white;border:1px solid green"</span>&gt;</span>
line 1<span class="tag">&lt;<span class="title">br</span>/&gt;</span>
line 2
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"display:table;clear:left;border:2px solid yellow"</span>&gt;</span>div content<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

 <span class="tag">&lt;<span class="title">p</span> <span class="attribute">style</span>=<span class="value">"clear:left"</span>&gt;</span>display:table-cell after float div without clear<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"border:1px solid red"</span>&gt;</span>
<span class="tag">&lt;<span class="title">p</span> <span class="attribute">style</span>=<span class="value">"float:left;background-color:gray;color:white;border:1px solid green"</span>&gt;</span>
line 1<span class="tag">&lt;<span class="title">br</span>/&gt;</span>
line 2
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"display:table-cell;border:2px solid yellow"</span>&gt;</span>div content<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

<span class="tag">&lt;<span class="title">p</span> <span class="attribute">style</span>=<span class="value">"clear:left"</span>&gt;</span>display:table-cell after float div with clear<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
 <span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"border:1px solid red"</span>&gt;</span>
<span class="tag">&lt;<span class="title">p</span> <span class="attribute">style</span>=<span class="value">"float:left;background-color:gray;color:white;border:1px solid green"</span>&gt;</span>
line 1<span class="tag">&lt;<span class="title">br</span>/&gt;</span>
line 2
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"display:table-cell;clear:left;border:2px solid yellow"</span>&gt;</span>div content<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
[/html]



实际运行效果图：
 <span class="tag">&lt;<span class="title">img</span> <span class="attribute">src</span>=<span class="value">"http://leivli.duapp.com/wp-content/uploads/2010/11/6-1024x362.png"</span> <span class="attribute">title</span>=<span class="value">"bfc_and_clear"</span> <span class="attribute">height</span>=<span class="value">"362"</span> <span class="attribute">width</span>=<span class="value">"1024"</span> <span class="attribute">alt</span>=<span class="value">""</span> <span class="attribute">class</span>=<span class="value">"aligncenter size-large wp-image-96"</span>&gt;</span><span class="tag">&lt;/<span class="title">img</span>&gt;</span>第一组是一个float div后跟着一个普通的无设置clear属性的div（无display属性）的情况，此时float div会覆盖后面的div，从边框可以看到，后面的div还是从包含div的左侧开始的
 第二组和第一组一样，只是后面的div设置了clear:left属性，这就使得后面的div排列在了float div的下面
 第三组中后面的div设置了display:table,但是没有设置clear属性，与第一组相比，该div的表现更像是一个ＢＦＣ，因为该div没有从包含div的左侧开始，而是从float div的右侧开始布局。
 这就是文章刚开始提到的，display:table本身不会新建一个bfc，但是由于它会使得内部元素生成display:talbe-cell的匿名框，而该匿名框会建立一个bfc
 第四组可以看出第三组中的bfc并不是display:table创建的，因为设置了clear:left后，该div到了float div的下面。
 最后两组是display:table-cell的情况，此时后面的div会建立一个bfc，由于和float的div分属不同的div，clear属性是不起作用的，这也就是为什么第五组设置了clear属性后，表现和第四组一样的原因
</pre></figure></code></pre>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2010-11-20T11:42:07.000Z"><a href="/2010/11/2010-11-20-free_green_vpn/">Nov 20 2010</a></time>
      
      
  
    <h1 class="title"><a href="/2010/11/2010-11-20-free_green_vpn/">一个申请免费VPN的地方</a></h1>
  

    </header>
    <div class="entry">
      
        <p>今天发现一个申请免费vpn的地方，一个月可以有200M的免费流量，而且有各种平台上的使用说明，很不错~</p>
<p>可以点这个链接：<a href="http://www.greenvpn.net/join.php?ref=leivli">GreenVPN</a>进入查看，:)</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2010-11-16T16:27:56.000Z"><a href="/2010/11/2010-11-17-wp-evernote-bug-fix/">Nov 17 2010</a></time>
      
      
  
    <h1 class="title"><a href="/2010/11/2010-11-17-wp-evernote-bug-fix/">WP Evernote Site Memory插件1.1.1一个小问题的修正</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Evernote是一个十分好用的笔记软件，针对wordpress有相应的WP Evernote Site Memory插件，安装完并进行相应的配置后，可以在每一篇博文开头或结尾有个小的evernote图标，点击后可以发送文章内容到读者自己的evernote笔记本中，十分方便。</p>
<p>在site memory的配置中有如下选项：</p>
<p><img src="file:///C:/Users/ADMINI%7E1/AppData/Local/Temp/moz-screenshot.png" alt=""><img src="file:///C:/Users/ADMINI%7E1/AppData/Local/Temp/moz-screenshot-1.png" alt=""><img src="http://leivli.duapp.com/wp-content/uploads/2010/11/11.png" alt="设置ContentID">即可以设定evernote获取页面哪一部分作为笔记内容，留空则可以使用id为“post-ID&quot;的div的内容，也即相应博文的内容。</p>
<p>但昨天装了1.1.1后，发现点击某篇博文下的evernote图标后，发送到笔记的内容是整个页面的内容而非单独那篇博文的内容，刚才简单追踪了一下，发现是该插件附带js的一个小bug：生成的按钮中调用clip方法时传递postID的属性名是&quot;contentID&quot;,而之后却使用属性名&quot;contentId&quot;进行读取,这样导致Evernote认为没有传递合适的postID，从而就抓取了整个页面的内容。</p>
<p>修改起来也十分简单，只需要将插件中所带的js文件（”plugins/wp-evernote-site-memory/js/noteit.js和noteit.min.js“）中所有的&quot;contentId&quot;替换为&quot;contentID&quot;即可。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2010-11-15T09:17:35.000Z"><a href="/2010/11/2010-11-15-php_input_post/">Nov 15 2010</a></time>
      
      
  
    <h1 class="title"><a href="/2010/11/2010-11-15-php_input_post/">php://input和$_POST</a></h1>
  

    </header>
    <div class="entry">
      
        <p>一个soap_server的实现框架代码如下：</p>
<p>[php]
$wsdlFile = realpath(dirname(<strong>FILE</strong>).&#39;/../wsdl/service.wsdl&#39;);
$actor = new soapServer($wsdlFile); //初始化soapServer
$actor-&gt;setClass(&#39;ServiceInterface&#39;);//导入方法
$actor-&gt;handle(file_get_contents(&#39;php://input&#39;)); //注意：这里使用了php://input
[/php]</p>
<p><strong>一个soap调用的数据是通过POST的方式发送给服务器的，那么上面的处理中为什么要使用php://input,是否可以使用$_POST？
</strong></p>
<p>一个典型的soap调用框架代码如下：</p>
<p>[php]
$client = new SoapClient(SOAP_SERVICEURL,array(&#39;trace&#39;=&gt;true));
//使用trace选项，可以保证后面的<strong>getLastRequest、</strong>getLastResponse等方法可以读取到相应的请求/响应
$ret = $client-&gt;getServiceName(&#39;serviceStr&#39;);
echo htmlspecialchars($client-&gt;<strong>getLastRequestHeaders());
 echo &quot;<br/>&quot;;
 echo htmlspecialchars($client-&gt;</strong>getLastRequest());
 echo &quot;<br/>&quot;;
 var_dump($ret);
 echo &quot;<br/>&quot;;
 echo htmlspecialchars($client-&gt;<strong>getLastResponseHeaders());
 echo &quot;<br/>&quot;;
 echo htmlspecialchars($client-&gt;</strong>getLastResponse());
 echo &quot;<br/>&quot;;
[/php]</p>
<p>以下是运行这段client后的输出：</p>
<p>[code]
POST <strong><strong> HTTP/1.1 Host: [*</strong></strong>] Connection: Keep-Alive User-Agent: PHP-SOAP/5.2.10 Content-Type: text/xml;
charset=utf-8 SOAPAction: &quot;urn:<strong><em>*</em></strong>#getServiceName&quot; Content-Length: <em>*</em></p>
<p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; <SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:ns1="urn:****" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"></p>
<p><SOAP-ENV:Body><ns1:getServiceName><servicename xsi:type="xsd:string">serviceStr</servicename></ns1:getServiceName></SOAP-ENV:Body>
</SOAP-ENV:Envelope></p>
<p>NULL</p>
<p>HTTP/1.1 200 OK Date: Mon, 15 Nov 2010 08:19:16 GMT Server: Apache/2.0.63 (Unix) PHP/5.2.10
X-Powered-By: PHP/5.2.10 Set-Cookie: <strong>*</strong>; path=/; domain=<em>*</em> Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Content-Length: 521
Keep-Alive: timeout=15, max=100 Connection: Keep-Alive Content-Type: text/xml; charset=utf-8</p>
<p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; <SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:ns1="urn:AmsInterfaceswsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body></p>
<p><ns1:getServiceNameResponse><return xsi:nil="true"/></ns1:getServiceNameResponse></SOAP-ENV:Body></SOAP-ENV:Envelope>
[/code]</p>
<p>由请求header可以看到，soap虽然使用的post的方式传输请求串，但是传递的数据是一个xml，content-type也是“text/xml”，而对于php://input,<a href="http://php.net/manual/en/wrappers.php.php">官方文档</a>给的是这样的说明:</p>
<p>php://input allows you to read raw data from the request body. In case of POST requests, it preferrable to <a href="http://www.php.net/manual/en/reserved.variables.httprawpostdata.php">$HTTP_RAW_POST_DATA</a> as it does not depend on special php.ini directives. Moreover, for those cases where <a href="http://www.php.net/manual/en/reserved.variables.httprawpostdata.php">$HTTP_RAW_POST_DATA</a> is not populated by default, it is a potentially less memory intensive alternative to activating <a href="http://www.php.net/manual/en/ini.core.php#ini.always-populate-raw-post-data">always_populate_raw_post_data</a>. php://input is not available with <em>enctype=&quot;multipart/form-data&quot;</em>.</p>
<blockquote>
<p><strong>Note</strong>:  A stream opened with php://input can only be read once; the stream does not support seek operations. However, depending on the SAPI implementation, it may be possible to open another php://input stream and restart reading. This is only possible if the request body data has been saved. Typically, this is the case for POST requests, but not other request methods, such as PUT or PROPFIND. </p>
</blockquote>
<p>也就是说php://input可以用来读取http post的raw request data。对于一般的表单post，http头中设置的contentType是&#39;application/x-form-www-urlencoded&#39;(无文件上传)或&#39;multipart/form-data&#39;(一般用于文件上传),这两种情况下，post的数据会被设置到$_POST中（第一种情况下，php://input也会被设置，第二种情况下，php://input则不会被设置），而对于text/xml这种类型，post数据并不会被设置到$_POST中，具体的post、get和php://input的实验可参考这篇<a href="http://tuzwu.javaeye.com/blog/798978">博文</a>。</p>
<p>这里只摘抄其测试结论：</p>
<p>1，Coentent-Type仅在取值为application/x-www-data-urlencoded和multipart/form-data两种情况下，PHP才会将http请求数据包中相应的数据填入全局变量$_POST
2，PHP不能识别的Content-Type类型的时候，会将http请求包中相应的数据填入变量$HTTP_RAW_POST_DATA
3,  只有Coentent-Type不为multipart/form-data的时候，PHP不会将http请求数据包中的相应数据填入php://input，否则其它情况都会。填入的长度，由Coentent-Length指定。
4，只有Content-Type为application/x-www-data-urlencoded时，php://input数据才跟$_POST数据相一致。
5，php://input数据总是跟$HTTP_RAW_POST_DATA相同，但是php://input比$HTTP_RAW_POST_DATA更凑效，且不需要特殊设置php.ini
6，PHP会将PATH字段的query_path部分，填入全局变量$_GET。通常情况下，GET方法提交的http请求，body为空。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2010-11-14T17:12:11.000Z"><a href="/2010/11/2010-11-15-greasemonkey-baidu-space/">Nov 15 2010</a></time>
      
      
  
    <h1 class="title"><a href="/2010/11/2010-11-15-greasemonkey-baidu-space/">百度空间插入代码段和HTML代码片段的GreaseMonkey脚本</a></h1>
  

    </header>
    <div class="entry">
      
        <p>现在百度空间写日志时，在IE/firefox下的文本编辑器是不能直接查看和编辑日志的HTML代码的，应该是基于安全考虑。目前在chrome下，百度空间的兼容性不好，写新日志或者编辑日志时，直接是提供的一个文本框，可以直接敲入HTML代码（当然了，写入<script>是会被过滤掉的)。</p>
<p>如果空间可以支持直接插入代码片段（语法高亮、缩进等等），则空间用来写技术文档就更方便了。最近刚好发现VIM的TOhtml命令非常强大，可以直接把编辑器中文本按照其颜色、缩进等生成相应的HTML片段，如果空间可以直接插入一段HTML代码的话，代码片段的插入也就不成问题了。</p>
<p>之前在<a href="http://www.laruence.com/">雪候鸟</a>的博客上看到了<a href="http://www.laruence.com/2010/03/31/1377.html">东方时尚约车脚本</a>相关的内容，联想我的需求，参考其东方时尚约车脚本写了一个简单的Greasemonkey脚本，主要在以下两方面对空间的编辑器进行了扩展：
1. 支持查看当前日志的HTML代码，以便进行简单的修改，和粘贴来自VIM的代码片段
2. 支持直接插入一段来自VIM的代码段，该代码段可以具有一定的样式，如常见的有边框包围，字体更清晰等等</p>
<p><strong>安装方法:</strong>
1. 需要firefox
2. firefox需要安装greaseMonkey插件, 插件地址: <a href="https://addons.mozilla.org/en-US/firefox/addon/748"><a href="https://addons.mozilla.org/en-US/firefox/addon/748">https://addons.mozilla.org/en-US/firefox/addon/748</a></a>
3. 用firefox浏览本页, 并<a href="http://userscripts.org/scripts/show/78912">点此</a>下载安装</p>
<p><strong>使用方法：</strong></p>
<p>安装后打开自己的空间，“新建文章”或者“编辑”已发布的日志时，在标题的右侧会出现“插入代码段“和”HTML视图“两个按钮，如下图：</p>
<p><img src="http://leivli.duapp.com/wp-content/uploads/1.png" alt=""></p>
<p>其中”<strong>插入代码段</strong>“可以直接插入一段代码段，如我们VIM中TOhtml一个php脚本文件的结果，然后复制到”代码段“中：</p>
<p><img src="http://leivli.duapp.com/wp-content/uploads/2.png" alt=""></p>
<p>以下是结果：</p>
<p>1 &lt;?php
2 <strong>$</strong>file <strong>=</strong> file(&quot;harddisk.txt&quot;);
3 <strong>foreach</strong>(<strong>$</strong>file <strong>as</strong> <strong>$</strong>line){
4  <strong>$</strong>line <strong>=</strong> trim(<strong>$</strong>line);
5  <strong>$</strong>s <strong>=</strong> preg_match_all(&quot;/(?:\d)+[GTM]/i&quot;,<strong>$</strong>line,<strong>$</strong>matches,PREG_PATTERN_ORDER);
6  <strong>if</strong>(<strong>!**</strong>$<strong>s){
7  echo &quot;error parse.. &quot;</strong>.<strong>**$</strong>line<strong>.</strong>&quot;\n&quot;;
8  }
9  <strong>else</strong> <strong>if</strong>(<strong>$</strong>s <strong>&gt;</strong> 1){
10  echo &quot;multi match .. &quot;<strong>.**</strong>$<strong>line</strong>.<strong>&quot;: \n&quot;;
11  </strong>foreach<strong>(</strong>$<strong>matches[0] </strong>as<strong> </strong>$<strong>match){
12  echo &quot;</strong>$<strong>match\n&quot;;
13  }
14  }
15  </strong>else<strong>{
16  echo &quot;find..&quot;</strong>.<strong>**$</strong>line<strong>.</strong>&quot;: \n&quot;;
17  echo <strong>$</strong>matches[0][0]<strong>.</strong>&quot;\n&quot;;
18  }
19 }
20 ?&gt;</p>
<p>代码段插入后，双击代码段可以进行<strong>编辑</strong>。</p>
<p>”<strong>HTML视图</strong>“则显示当前日志的HTML代码，可以直接编辑：</p>
<p><img src="http://leivli.duapp.com/wp-content/uploads/3.png" alt="">
该对话框上面的”更新“按钮可以将改动写回空间的编辑器，而”加载“则是可以再次加载空间编辑器中的内容</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2010-11-14T15:18:45.000Z"><a href="/2010/11/2010-11-14-vim-force-overwrite/">Nov 14 2010</a></time>
      
      
  
    <h1 class="title"><a href="/2010/11/2010-11-14-vim-force-overwrite/">VIM overwrite read-only file</a></h1>
  

    </header>
    <div class="entry">
      
        <p>今天在使用vim编辑一个read-only的文件（权限为r-- r-- r--)，在保存时虽然提示只读不能保存，但是通过w!可以强制覆盖原文件内容，难道VIM可以绕过权限限制么？</p>
<p>后来发现是在使用w！时，vim会强制删除原文件，并新建一个新的同名文件，并写入新的内容，所以，使用w！强制保存时，就要求当前用户有删除原文件的权限，即：</p>
<ol>
<li>该文件所在的目录必须具有w权限</li>
</ol>
<ol>
<li>如果所在目录设置了t标志，还需要当前文件的所有者为自己</li>
</ol>
<p>其实这也可以从vim的帮助中看到：</p>
<p><em>write-readonly</em></p>
<p>When the &#39;cpoptions&#39; option contains &#39;W&#39;, Vim will refuse to overwrite a</p>
<p>readonly file.  When &#39;W&#39; is not present, &quot;:w!&quot; will overwrite a readonly file,</p>
<p>if the system allows it (the directory must be writable).</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2010-11-12T06:44:38.000Z"><a href="/2010/11/2010-11-12-wget-mirror/">Nov 12 2010</a></time>
      
      
  
    <h1 class="title"><a href="/2010/11/2010-11-12-wget-mirror/">wget下载整个网站的镜像</a></h1>
  

    </header>
    <div class="entry">
      
        <p><span style="background-color: #ffff00;">$ wget --mirror -p --convert-links -P ./LOCAL-DIR WEBSITE-URL</span></p>
<ul>
<li>–mirror : 下载镜像</li>
</ul>
<ul>
<li>-p : 下载gif等显示html必须的资源</li>
</ul>
<ul>
<li>–convert-links : 下载后，将文档中所有的链接进行转换，以支持本地查看</li>
</ul>
<ul>
<li>-P ./LOCAL-DIR : 需要保存下载文档的目录</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  

  <nav id="pagination">
  
  
    <a href="/archives/2010/11/page/2/" class="alignright next">Next</a>
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:leiqzhang.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/HTTP/">HTTP</a><small>2</small></li>
  
    <li><a href="/categories/JavaScriptCSS/">JavaScript/CSS</a><small>2</small></li>
  
    <li><a href="/categories/LinuxUnix/">Linux/Unix</a><small>3</small></li>
  
    <li><a href="/categories/MySQL/">MySQL</a><small>2</small></li>
  
    <li><a href="/categories/MySQL/PHP/">PHP</a><small>1</small></li>
  
    <li><a href="/categories/PHP/">PHP</a><small>2</small></li>
  
    <li><a href="/categories/QEMU/">QEMU</a><small>9</small></li>
  
    <li><a href="/categories/QEMU/Virtualization/">Virtualization</a><small>9</small></li>
  
    <li><a href="/categories/WordPress/">WordPress</a><small>2</small></li>
  
    <li><a href="/categories/vim/">vim</a><small>3</small></li>
  
    <li><a href="/categories/virtualization/">virtualization</a><small>1</small></li>
  
    <li><a href="/categories/virtualization/vmware/">vmware</a><small>1</small></li>
  
    <li><a href="/categories/未分类/">未分类</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/bfc/">bfc</a><small>1</small></li>
  
    <li><a href="/tags/cache-control/">cache-control</a><small>1</small></li>
  
    <li><a href="/tags/collapse/">collapse</a><small>1</small></li>
  
    <li><a href="/tags/css/">css</a><small>1</small></li>
  
    <li><a href="/tags/dataplane/">dataplane</a><small>1</small></li>
  
    <li><a href="/tags/ervernote/">ervernote</a><small>1</small></li>
  
    <li><a href="/tags/etag/">etag</a><small>1</small></li>
  
    <li><a href="/tags/expires/">expires</a><small>1</small></li>
  
    <li><a href="/tags/float/">float</a><small>1</small></li>
  
    <li><a href="/tags/greasemonkey/">greasemonkey</a><small>1</small></li>
  
    <li><a href="/tags/hasLayout/">hasLayout</a><small>1</small></li>
  
    <li><a href="/tags/http/">http</a><small>2</small></li>
  
    <li><a href="/tags/javascript/">javascript</a><small>1</small></li>
  
    <li><a href="/tags/kvm/">kvm</a><small>9</small></li>
  
    <li><a href="/tags/last-modified/">last-modified</a><small>1</small></li>
  
    <li><a href="/tags/libvirt/">libvirt</a><small>8</small></li>
  
    <li><a href="/tags/lighthttpd/">lighthttpd</a><small>1</small></li>
  
    <li><a href="/tags/linux/">linux</a><small>1</small></li>
  
    <li><a href="/tags/mac/">mac</a><small>1</small></li>
  
    <li><a href="/tags/margin/">margin</a><small>1</small></li>
  
    <li><a href="/tags/md5sum/">md5sum</a><small>1</small></li>
  
    <li><a href="/tags/mysql/">mysql</a><small>2</small></li>
  
    <li><a href="/tags/patch/">patch</a><small>1</small></li>
  
    <li><a href="/tags/pdo/">pdo</a><small>1</small></li>
  
    <li><a href="/tags/perf/">perf</a><small>1</small></li>
  
    <li><a href="/tags/permalink/">permalink</a><small>1</small></li>
  
    <li><a href="/tags/php/">php</a><small>2</small></li>
  
    <li><a href="/tags/position/">position</a><small>1</small></li>
  
    <li><a href="/tags/post/">post</a><small>1</small></li>
  
    <li><a href="/tags/proxy/">proxy</a><small>1</small></li>
  
    <li><a href="/tags/qemu/">qemu</a><small>9</small></li>
  
    <li><a href="/tags/rewrite/">rewrite</a><small>1</small></li>
  
    <li><a href="/tags/scsi/">scsi</a><small>1</small></li>
  
    <li><a href="/tags/site-memory/">site memory</a><small>1</small></li>
  
    <li><a href="/tags/soap/">soap</a><small>1</small></li>
  
    <li><a href="/tags/sql/">sql</a><small>1</small></li>
  
    <li><a href="/tags/svn/">svn</a><small>1</small></li>
  
    <li><a href="/tags/tip/">tip</a><small>1</small></li>
  
    <li><a href="/tags/tree_conflict/">tree_conflict</a><small>1</small></li>
  
    <li><a href="/tags/vim/">vim</a><small>3</small></li>
  
    <li><a href="/tags/virtio/">virtio</a><small>1</small></li>
  
    <li><a href="/tags/vmware/">vmware</a><small>1</small></li>
  
    <li><a href="/tags/vpn/">vpn</a><small>1</small></li>
  
    <li><a href="/tags/wget/">wget</a><small>1</small></li>
  
    <li><a href="/tags/wordpress/">wordpress</a><small>2</small></li>
  
  </ul>
</div>


  

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2013 leiqzhang
  
</div>
<div class="clearfix"></div></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'leiqzhang';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>